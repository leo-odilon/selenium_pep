name: Request API

on: workflow_call

jobs:
  api-request:
    runs-on: ubuntu-latest
    environment: master

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Make call using shell script
        shell: bash
        id: call_api
        run: |
          chmod +x ./token_request.sh
          ./token_request.sh "${{ secrets.USERNAME }}" "${{ secrets.PASSWORD }}" "${{ secrets.CLIENT_ID }}" "${{ secrets.CLIENT_SECRET }}" "${{ vars.TOKEN_URL }}"

      - name: Use access_token
        run: |
          echo "Access token: ${{ steps.call_api.outputs.access_token }}"