name: Request API

on: workflow_call

jobs:
  api-request:
    runs-on: ubuntu-latest
    environment:
        name: master

    steps:
      - name: Obter token de autenticação
        id: obter_token
        run: |
          response=$(curl -X POST ${{ vars.TOKEN_URL }} \
            -d "grant_type=password" \
            -d "client_id=${{ secrets.CLIENT_ID }}" \
            -d "client_secret=${{ secrets.CLIENT_SECRET }}" \
            -d "username=${{ secrets.USERNAME }}" \
            -d "password=${{ secrets.PASSWORD }}")
          echo "response=$response"
          token=$(echo $response | jq -r '.access_token')
          echo "::set-output name=token::$token"

      - name: Usar o token de autenticação
        run: |
          echo "Token de autenticação: ${{ steps.obter_token.outputs.token }}"
          # Exemplo de uso do token para fazer uma requisição API
